[
  {
    "objectID": "posts/consensusClustering/consensus_clustering.html",
    "href": "posts/consensusClustering/consensus_clustering.html",
    "title": "Circumventing poor mixing in Bayesian model-based clustering",
    "section": "",
    "text": "Paper: Consensus Clustering for Bayesian Mixture Models\n\nAim: Perform inference on Bayesian clustering methods when chains do not converge without reimplementation\nPros: Easy to use and offers useful inference\nCons: Inference is no longer Bayesian"
  },
  {
    "objectID": "posts/consensusClustering/consensus_clustering.html#introduction",
    "href": "posts/consensusClustering/consensus_clustering.html#introduction",
    "title": "Circumventing poor mixing in Bayesian model-based clustering",
    "section": "Introduction",
    "text": "Introduction\nThe first paper of my PhD was entitled “Consensus Clustering for Bayesian Mixture Models” and written with my supervisors Paul and Chris. To overcome the issue of poor mixing that haunts Bayesian clustering, we proposed a heuristic method based on the consensus clustering algorithm of Monti et al. (2003) that appears to enable principled inference without reimplementing the sampler. However, the inference does lose the Bayesian interpretation.\nIf you have attempted to infer discrete latent structure using a Bayesian method implemented using Markov Chain Monte Carlo (MCMC) methods, then you’ve probably encountered the problem of poor mixing where chains become trapped in different clusterings and stop exploring the parameter space.There is a large body of literature about methods for navigating this problem in a principled fashion (see, e.g., Dahl 2003; Jain and Neal 2004; Bouchard-Côté, Doucet, and Roth 2017; Syed et al. 2022), but these state-of-the-art samplers tend to be time-consuming to implement. In this paper we proposed taking samples from many (relatively) short chains rather than a single long chain. This idea has seen a lot of mileage recently across a few different papers, but where we differ is we surrender our claim of being truly Bayesian. We have to do this as, while it is possibly that our samples are drawn from the target density, they are unlikely to be weighted correctly. However, we found that the expected values from the distributions sampled this way tended to be correct even if the variance might be too large."
  },
  {
    "objectID": "posts/consensusClustering/consensus_clustering.html#algorithm",
    "href": "posts/consensusClustering/consensus_clustering.html#algorithm",
    "title": "Circumventing poor mixing in Bayesian model-based clustering",
    "section": "Algorithm",
    "text": "Algorithm\nThe basic method is sketched below:\n\nConsensus clustering for Bayesian methods\nInputs:\n  W: the number of chains to run\n  D: the number of iterations to run each chain for\n  sampler: the MCMC sampler for the method\n  priorDraw(): a method of drawing a sample from the prior distribution over the clustering space (this is often integrated into the sampler in practice)\n \nOutput:\n  c: a matrix of sampled partitions\n\nAlgorithm:\n  for(w in 1:W) {\n    # Differentiate the model runs using the random seed\n    set.seed(w);\n    c_0 <- prior();\n    for(r in 1:R) {\n      # Sample a new clustering based on the current partition\n      c_r <- sampler(c_r);\n    }\n    # Save the last iteration\n    c[w] <- c_r\n  }\n\nObviously one can sample more quantities than just the clustering (as we do in the paper), but I think that clustering works particularly well with short chains. This is because we often care about co-clustering probabilities across sampled partitions rather than any single sample being correct; this means that if there is enough variety across a large number of poor (but better than random) sampled partitions we might still infer the correct structure. For other variables we expect that we need longer chains to have the correct expected value from our sampled distribution. The Multiple Dataset Integration (MDI) example in the paper is a good example of this. MDI is an integrative or multi-view Bayesian clustering method. Signal is shared across datasets to inform clustering in each view and the degree to which information should be shared is also inferred. This is represented by the \\(\\phi\\) parameters in the model. To learn meaningful estimate of \\(\\phi\\) and infer dependent clusterings we need to go much further into the chains then we do for clustering a single dataset. This is because for the information to be shared and how it is shared depends on the global clustering structure emerging. This means that the Markov chains have to reach their target density for consensus clustering to offer a useful inference and the chains are long. This means we lose the massive speed gain that very short chains offer, but we still overcome the multi-modality so often present in the posterior distribution of complex latent structure models. Based on this result we suspect that the method generalises to any Bayesian model, but for this vignette I will only explore clustering of a single dataset."
  },
  {
    "objectID": "posts/consensusClustering/consensus_clustering.html#guessing-chain-length",
    "href": "posts/consensusClustering/consensus_clustering.html#guessing-chain-length",
    "title": "Circumventing poor mixing in Bayesian model-based clustering",
    "section": "Guessing chain length",
    "text": "Guessing chain length\nTo use consensus clustering, we want to have an idea of how long we will need to run the chains for. In this case we run a small number of chains for longer than necessary and the look at trace plots to see when they stopped exploring or the degree of exploration had tapered off significantly.\n\nn_initial_chains <- 9\nR_long <- 5000\nthin_long <- 50\niterations_initial <- seq(0, R_long, thin_long)\n\nn_samples <- floor(R_long / thin_long) + 1\ntype <- \"G\"\n\npsms <- initial_mcmc <- vector(\"list\", n_initial_chains)\nlikelihood_df <- matrix(0, nrow = n_samples - 1, ncol = n_initial_chains)\ncolnames(likelihood_df) <- paste0(\"Chain\", seq(1, n_initial_chains))\n\nari_mat <- concentration_df <- matrix(0, nrow = n_samples, ncol = n_initial_chains)\ncolnames(ari_mat) <- colnames(concentration_df) <- paste0(\"Chain\", seq(1, n_initial_chains))\n\nensemble_psm <- matrix(0, nrow = N, ncol = N)\n\nfor (ii in seq(1, n_initial_chains)) {\n  initial_mcmc[[ii]] <- .mcmc <- callMixtureModel(my_data, R_long, thin_long, type)\n  likelihood_df[, ii] <- .mcmc$complete_likelihood[-1]\n  concentration_df[, ii] <- .mcmc$mass\n  ari_mat[, ii] <- apply(.mcmc$allocations, 1, function(x) {mcclust::arandi(x, .mcmc$allocations[n_samples, ])})\n  .psm <- makePSM(initial_mcmc[[ii]]$allocations)\n  row.names(.psm) <- colnames(.psm) <- row.names(my_data)\n  psms[[ii]] <- .psm\n  ensemble_psm <- ensemble_psm + .psm\n}\n\nensemble_psm <- ensemble_psm / n_initial_chains\n\n\nari_df <- ari_mat |> \n  as.data.frame() |> \n  mutate(Iteration = iterations_initial) |>\n  pivot_longer(-Iteration, names_to = \"Chain\", values_to = \"ARI\")\n\nlikelihood_df2 <- likelihood_df |>\n  as.data.frame() |>\n  mutate(Iteration = iterations_initial[-1]) |>\n  pivot_longer(-Iteration, names_to = \"Chain\", values_to = \"Complete_log_likelihood\")\n\nmass_df <- concentration_df |>\n  as.data.frame() |>\n  mutate(Iteration = iterations_initial) |>\n  pivot_longer(-Iteration, names_to = \"Chain\", values_to = \"Mass\")\n\nlikelihood_df2 |>\n  ggplot(aes(x = Iteration, y = Complete_log_likelihood, group = Chain)) +\n  geom_line() +\n  ggthemes::scale_color_colorblind()\n\n\n\nmass_df |>\n  ggplot(aes(x = Iteration, y = Mass, group = Chain)) +\n  geom_line() +\n  ggthemes::scale_color_colorblind()\n\n\n\nari_df |> \n  ggplot(aes(x = Iteration, y = ARI, group = Chain)) +\n  geom_line() +\n  ggthemes::scale_color_colorblind() +\n  labs(title = \"ARI between rth sampled partition and final sampled partition in each chains\")\n\n\n\n\nThese long chains have stopped exploring new clusterings almost instantly. Two chains do one large change several thousand iterations into the sampler, but all chains find a partition similar to the final sampled partition within 1,000 iteration. The mass parameter takes awhile to converge, but this is sampled via Metropolis-Hastings, so this makes sense.\n\npsm <- makePSM(.mcmc$allocations)\nrow.names(psm) <- colnames(psm) <- row.names(my_data)\n\n# Create the heatmap of the PSM\npheatmap::pheatmap(psm,\n  color = simColPal(),\n  breaks = defineBreaks(simColPal(), lb = 0),\n  annotation_row = anno_row,\n  annotation_colors = ann_colours,\n  main = \"Example PSM annotated by clusterings\",\n  show_rownames = FALSE,\n  show_colnames = FALSE\n)\n\n\n\npsm_df <- prepSimilarityMatricesForGGplot(psms)\n\npsm_df |>\n  ggplot(aes(x = x, y = y, fill = Entry)) +\n  geom_tile() +\n  facet_wrap(~Chain) +\n  scale_fill_gradient(\n    low = \"#FFFFFF\",\n    high = \"#146EB4\"\n  ) +\n  labs(title = \"PSMs for initial chains with common ordering\")\n\n\n\n\nThese PSMs also show why nested \\(\\hat{R}\\) and coupling don’t work for clustering. These methods assume that the different chains can eventually reach similar places; this is unlikely to happen in any reasonable length of time in even as low-dimensional an example as this (70 features; hardly low-dimensional in many settings, but that’s one of the joys of ’omics). These PSMs essentially binary, suggesting the same partition is sampled repeatedly; only chains 7 and 8 appear to capture any variety in the clusterings."
  },
  {
    "objectID": "posts/consensusClustering/consensus_clustering.html#depth-tests",
    "href": "posts/consensusClustering/consensus_clustering.html#depth-tests",
    "title": "Circumventing poor mixing in Bayesian model-based clustering",
    "section": "Depth tests",
    "text": "Depth tests\nEssentially we will follow the logic of Geweke and compare the distribution using early samples to later samples. We differ in that the two sets of samples are collected across many chains, but I think the logic holds. Here we use a t test to test if the sampled distributions of the mass parameter for the clustering and the complete log-likelihood are the same in earlier samples to the same distributions for the final sample from all the chains.\n\nm1 <- mass_df$Mass[mass_df$D == 100]\nm2 <- mass_df$Mass[mass_df$D == 300]\nm3 <- mass_df$Mass[mass_df$D == 600]\nm4 <- mass_df$Mass[mass_df$D == 1000]\n\nl1 <- lkl_df$Complete_log_likelihood[lkl_df$D == 100]\nl2 <- lkl_df$Complete_log_likelihood[lkl_df$D == 300]\nl3 <- lkl_df$Complete_log_likelihood[lkl_df$D == 600]\nl4 <- lkl_df$Complete_log_likelihood[lkl_df$D == 1000]\n\nt_d1_m_1 <- t.test(m1, m4)\nt_d1_m_2 <- t.test(m2, m4)\nt_d1_m_3 <- t.test(m3, m4)\n\nt_d1_l_1 <- t.test(l1, l4)\nt_d1_l_2 <- t.test(l2, l4)\nt_d1_l_3 <- t.test(l3, l4)"
  },
  {
    "objectID": "posts/consensusClustering/consensus_clustering.html#width-tests",
    "href": "posts/consensusClustering/consensus_clustering.html#width-tests",
    "title": "Circumventing poor mixing in Bayesian model-based clustering",
    "section": "Width tests",
    "text": "Width tests\nTesting if we are using a sufficient quantity of chains is harder as the chains are not ordered. I believe we can essentially copy the Geweke test again but compare disjoint subsets of samples. For example, take the final sample from a random two fifths of the chains and compare the distribution for these to the distribution from the remaining three fifths and then repeat this multiple times.\n\nfrac_used <- 0.4\ninds1 <- sample(seq(1, W), size = W * frac_used, replace = FALSE)\ninds2 <- sample(seq(1, W), size = W * frac_used, replace = FALSE)\ninds3 <- sample(seq(1, W), size = W * frac_used, replace = FALSE)\ninds4 <- sample(seq(1, W), size = W * frac_used, replace = FALSE)\ninds5 <- sample(seq(1, W), size = W * frac_used, replace = FALSE)\n\nt_w1_m <- t.test(m3[inds1], m3[-inds1])\nt_w1_l <- t.test(l3[inds1], l3[-inds1])\n\nt_w2_m <- t.test(m3[inds2], m3[-inds2])\nt_w2_l <- t.test(l3[inds2], l3[-inds2])\n\nt_w3_m <- t.test(m3[inds3], m3[-inds3])\nt_w3_l <- t.test(l3[inds3], l3[-inds3])\n\nt_w4_m <- t.test(m3[inds4], m3[-inds4])\nt_w4_l <- t.test(l3[inds4], l3[-inds4])\n\nt_w5_m <- t.test(m3[inds5], m3[-inds5])\nt_w5_l <- t.test(l3[inds5], l3[-inds5])\n\n\ntest_df <- data.frame(\n  \"D\" = c(100, 300, 600, D, D, D, D, D),\n  \"W\" = c(W, W, W, 0.2 * W, 0.2 * W, 0.2 * W, 0.2 * W, 0.2 * W),\n  \"Mass\" = c(\n    t_d1_m_1$p.value,\n    t_d1_m_2$p.value,\n    t_d1_m_3$p.value,\n    t_w1_m$p.value,\n    t_w2_m$p.value,\n    t_w3_m$p.value,\n    t_w4_m$p.value,\n    t_w5_m$p.value\n  ),\n  \"Complete_log_likelihood\" = c(\n    t_d1_l_1$p.value,\n    t_d1_l_2$p.value,\n    t_d1_l_3$p.value,\n    t_w1_l$p.value,\n    t_w2_l$p.value,\n    t_w3_l$p.value,\n    t_w4_l$p.value,\n    t_w5_l$p.value\n  )\n)\n\n# test_df$Mass <- round(test_df$Mass, 4)\n# test_df$Complete_log_likelihood <- round(test_df$Complete_log_likelihood, 4)\n\nNow the p values for the mass parameter and complete log-likelihood t-tests are shown in the below table.\n\nknitr::kable(test_df, caption = \"Convergence tests for consensus clustering\", digits = 3)\n\n\nConvergence tests for consensus clustering\n\n\nD\nW\nMass\nComplete_log_likelihood\n\n\n\n\n100\n500\n0.000\n0.508\n\n\n300\n500\n0.000\n0.810\n\n\n600\n500\n0.651\n0.931\n\n\n1000\n100\n0.630\n0.446\n\n\n1000\n100\n0.137\n0.395\n\n\n1000\n100\n0.485\n0.627\n\n\n1000\n100\n0.328\n0.466\n\n\n1000\n100\n0.217\n0.067\n\n\n\n\n\nThe mass is sampled via Metropolis Hastings, so it taking longer to converge than the complete log-likelihood (which is a direct function of the clustering) is not shocking."
  },
  {
    "objectID": "posts/consensusClustering/consensus_clustering.html#mean-abolute-difference-between-consensus-matrices",
    "href": "posts/consensusClustering/consensus_clustering.html#mean-abolute-difference-between-consensus-matrices",
    "title": "Circumventing poor mixing in Bayesian model-based clustering",
    "section": "Mean abolute difference between consensus matrices",
    "text": "Mean abolute difference between consensus matrices\nIn the paper I recommended using the below kind of plots, but these need more models for assessing as with only three levels of both the iteration and number of chains used we only have two data points for comparisons, so they have some limitations.\n\nmean_abs_diff_df <- makeCMComparisonSummaryDF(cms, models)\n\nmean_abs_diff_df |>\n  dplyr::filter(Quantity_varied == \"Depth\") |>\n  ggplot(aes(x = Depth, y = Mean_absolute_difference, color = factor(Width))) +\n  geom_line() +\n  labs(title = \"Assessing stability across cms for increasing chain depth\") +\n  ggthemes::scale_color_colorblind()\n\n\n\nmean_abs_diff_df |>\n  dplyr::filter(Quantity_varied == \"Width\") |>\n  ggplot(aes(x = Width, y = Mean_absolute_difference, color = factor(Depth))) +\n  geom_line() +\n  labs(title = \"Assessing stability across cms for increasing numbers of chains\") +\n  ggthemes::scale_color_colorblind()"
  },
  {
    "objectID": "posts/Cyprus/index.html",
    "href": "posts/Cyprus/index.html",
    "title": "Cyprus",
    "section": "",
    "text": "I attended the Bayesian Non-Parametric Networking Event in Nicosia, Cyprus and then wandered around the interior of the island. An immense time.\nNotes:\n\nThe BNP community are very friendly despite the intimdation factor of David Dunson, Aad van der Vaart and Judith Rousseau; I will attend as many of BNP events as possible in the future as is possible.\nCyprus is great and has more variety than I expect, but I’m very glad I wasn’t there even two weeks later, too much sun for me.\nRome2Rio is a fantastic app and made the trip into the interior feasible."
  },
  {
    "objectID": "posts/Cyprus/index.html#background",
    "href": "posts/Cyprus/index.html#background",
    "title": "Cyprus",
    "section": "Background",
    "text": "Background\nI was delighted/massively intimidated to be offered a speaking slot at the BNP Networking Event in Cyprus in April 2022. I was delighted as Cyprus was meant to be great, but intimidated as my work wasn’t really non-parametric (or arguably even Bayesian) and I knew from the agenda that Aad van der Vaart and Judith Rousseau would be there; two people who have provided immensely important and innovative contributions to Bayesian non-parametrics. David Dunson would also be going, but I figured David was likely to appreciate my work on pragmatic grounds, but still, I was not without additional trepidation due to this factor - I’m a big fan of David’s work.\nRegardless, I was going and decided to try and do something I’d wanted to do for awhile, a running holiday. I planned to get a bus from Nicosa into the interior and basically circumvent the Cypriot Mt. Olympus (not to be confused with the Grecian or Martian mountains of the same name). So even if I had a crippling rejection from all of the academics I most admired I would probably have a nice time of it. My old Vibrams were wearing thin, so I presented myself with a pair of the new V-trail 2.0 as I expected to be off-piste for a large chunk of the running. I was a little anxious that I hadn’t broken them in enough as I expected to be going serious distance a day wearing a backpack; I had only done about 40km before heading out.\nI also made sure to check out speciality coffee bars in Nicosa using the European Coffee Trip. I was determined to hit “A \\(\\kappa\\chi\\)offee project” at the least.\nThus, a holiday of Bayes, barefoot running and coffee was born."
  },
  {
    "objectID": "posts/Cyprus/index.html#nicosia-bnp-and-a-fantastic-coffee",
    "href": "posts/Cyprus/index.html#nicosia-bnp-and-a-fantastic-coffee",
    "title": "Cyprus",
    "section": "Nicosia, BNP and a fantastic coffee",
    "text": "Nicosia, BNP and a fantastic coffee\nI got into Nicosia quite late the day before the conference began; I hadn’t appreciated how far away Cyprus is, but the shuttle from Larnaca airport into Nicosia was cheap (I think 8 euro?) and pretty easy. I eventually got into my flat for the week which was down by Konstantinou & Elenis cemetary. I wanted to be near enough to both a park and the University where the conference was being hosted, and this fit the bill, as well as giving me some space where I could unwind, work and cook for myself.\nI displayed immense wisdom on the first morning. I didn’t go out for a run and instead made an approximation of shakshouka. The day was already set-up to be intensely hot (by my Irish standards at least). Everyday in Nicosia would hover around the \\(30^o\\)C mark for a few hours around midday; thankfully the theatre the conference talks were in was plenty cool.\nI think there was about 70 people in attendance in total, and it took awhile for everyone to trickle in. I was pretty excited for the tutorials, David would be opening and I had enjoyed previous talks of his (including one which I technically hosted), and his tutorial “Some musings on Bayesian non-parametrics” sounded open enough to accessible and interesting. I wasn’t familiar with Yanxun Xu, but her work was very applied so I expected to enjoy it. I was not sure how much of Aad’s tutorial I’d follow with a lack of technical background, but I was looking forward to the challenge as this is the man who wrote the book on BNP.\nMost of the talks were over my head throughout the conference, so I’m not going to even attempt discuss all of the talks as I could not do them justice. Instead I’ll mention a few I particularly resonated with:\n\nLasse Vuursteen, “A Bayesian approach to multiview learning”.\nJudith Rousseau, “Bayesian nonparametric estimation of a density living near an unknown manifold”.\nChris Holmes, “Why don’t Bayesians bootstrap?” (I think this is the appropriate paper).\nThibault Randrianarisoa, “Smoothing and adaptation of shifted Pólya Tree ensembles”.\nDeborah Sulem, “Bayesian nonparametric estimation of nonlinear Hawkes processes”.\nJordan Bryan, “The multirank likelihood and cyclically monotone Monte Carlo: a semiparametric approach to CCA”.\nMinh-Lien Jeanne Nguyen, “Bernstein-von Mises for semiparametric mixture”.\nMariia Vladimirova, “Bayesian Neural Networks at Finite and Infinite Widths”.\nDennis Nieman, “Contraction rates and uncertainty quantification for variational Bayes”.\n\nI unfortunately had to miss a set of talks to host an online talk from Trevor Campbell about his and his group’s work on Bayesian coresets. This loss was mitigated by how great a talk Trevor gave. The work itself is very interesting (hence why I had been attempting to wrangle an invite to Trevor to speak for awhile), but Trevor has also clearly thought a lot about how to convey information and how to present his work.\nMy own talk went down well, with both David and Sara Wade being particularly positive. It was really nice to have the opportunity to discuss the work a little with them both.\nI found the conference very wearing though; I’m not fluent in BNP, the travel to be there and that level of exposure to people was just a lot. As a reward I gave myself leave to come in late on the Friday, and hit up “A \\(\\kappa\\chi\\)offee project”. I had a beautiful iced filter coffee, the aromatics came through really clearly. One of the nicest coffees I have had."
  },
  {
    "objectID": "posts/Cyprus/index.html#running",
    "href": "posts/Cyprus/index.html#running",
    "title": "Cyprus",
    "section": "Running",
    "text": "Running\n\nlibrary(leaflet)\nleaflet() %>%\n  addTiles() %>%\n  addMarkers(\n    lng=32.863873641417335, \n    lat=34.936726200280894, \n    label=\"Mt. Olympus\"\n  ) %>% \n  addProviderTiles(providers$CartoDB.Positron)\n\n\n\n\n\nThe running was great. I bussed down to Kyperounta, did the Madari Circular trail, slept, walked/ran to Pedoulas via Artemis Lake (which is really more a pond?). Pedoulas was pleasant, but this entire day was spent going uphill essentially so I was destroyed. Pedoulas to Pano Platres, Millomeris Waterfall, Caledonian Waterfall, etc. It was fascinating the range of terrains covered; there’s varying soil types and access to water varies a lot with obvious consequences for the vegetations. There’s some pictures below to convey this. I had an amazing time over these days, some of the most enjoyment I have had out of a holiday in a long time.\n\n\n\nThe friendly locals of Pedoulas.\n\n\n\n\n\n\n\n\n\n(a)\n\n\n\n\n\n\n\n(b)\n\n\n\n\n\n\n\n\n\n(c)\n\n\n\n\n\n\n\n(d)\n\n\n\n\n\n\n\n\n\n(e)\n\n\n\n\n\n\n\n(f)\n\n\n\n\n\n\n\n\n\n(g)\n\n\n\n\n\n\n\n(h)\n\n\n\n\n\n\n\n\n\n(i)\n\n\n\n\n\n\n\n(j)\n\n\n\n\n\n\n\n\n\n(k)\n\n\n\n\n\n\n\n(l)\n\n\n\n\n\n\n\n\n\n(m)\n\n\n\n\n\n\n\n(n)\n\n\n\n\n\n\n\n\n\n(o)\n\n\n\n\n\n\n\n(p)\n\n\n\n\n\n\n\n\n\n(q)\n\n\n\n\n\n\n\n(r)\n\n\n\n\n\n\n\n\n\n(s)\n\n\n\n\n\n\n\n(t)\n\n\n\n\n\n\n\n\n\n(u)\n\n\n\n\n\n\n\n(v)\n\n\n\n\n\n\n\n\n\n(w)\n\n\n\n\n\n\n\n(x)\n\n\n\n\nFigure 1: Trails in the interior"
  },
  {
    "objectID": "posts/Cyprus/index.html#cats",
    "href": "posts/Cyprus/index.html#cats",
    "title": "Cyprus",
    "section": "Cats",
    "text": "Cats\nCyprus aslo has many stray cats. Here are some.\n\n\n\n\n\n\n\n(a)\n\n\n\n\n\n\n\n(b)\n\n\n\n\n\n\n\n\n\n(c)\n\n\n\n\n\n\n\n(d)\n\n\n\n\n\n\n\n\n\n(e)\n\n\n\n\n\n\n\n(f)\n\n\n\n\nFigure 2: The cats of Cyprus"
  },
  {
    "objectID": "posts/Canada/index.html",
    "href": "posts/Canada/index.html",
    "title": "Montreal - BAYSM and ISBA",
    "section": "",
    "text": "I attended the BAyesian Young Statisticians Meeting (BAYSM) and the International Society for Bayesian Analysis in Montreal in June. BAYSM was great, despite intense jet lag, though the keynotes were three people who have all made significant contributions to (among other things) model-based clustering: Adrian Raftery, Sylvia Frühwirth-Schnatter and Amy Herring. Also, a number of people I’d met at the BNP meeting in Cyprus were in attendence which was a delight. This was two days and less than 100 people. ISBA was a much more intense affair. I think about 600 people attended in the end? It lasted the week and had very long and full days. Though I also only started sleeping correctly in the last two days, so my sleep deficit was pretty strong, so I might be overstating it."
  },
  {
    "objectID": "posts/Canada/index.html#baysm",
    "href": "posts/Canada/index.html#baysm",
    "title": "Montreal - BAYSM and ISBA",
    "section": "BAYSM",
    "text": "BAYSM\nI really recommend BAYSM to any junior Bayesians. It was very well done and most of the speakers had clearly thought about making their work accessible so I enjoyed many of the talks which covered quite an array of subjects. I also spoke myself about my batch-correction method, so that was fun. I think my talk went down pretty well, certainly I got laughs at all the spots I had hoped to (and, more importantly, none of the spots I hadn’t) and had some questions from both Amy and Sylvia which was cool. Jason Roy, the chair of my session, also some nice questions.\nFrom the other talks the two standouts for me were from Bella Deutsch and Renato Berlinghieri. Bella made me feel like an understood Hawke’s Processes and Approximate Bayesian Computation for a few hours, her paper is on arXiv [@Deutsch2020ABCHawkes]. Renato had delightful slides and some very nice material in his talk about using Gaussian processes to model ocean currents."
  },
  {
    "objectID": "posts/Canada/index.html#isba",
    "href": "posts/Canada/index.html#isba",
    "title": "Montreal - BAYSM and ISBA",
    "section": "ISBA",
    "text": "ISBA\nI had a poster covering the same material as my BAYSM talk. My memory of ISBA is limited at this point, but some highlights include conversations with Saif Syed and Brian Trippe and a jazz evening where Jordan Bryan and Dennis Niemann astounded us with their musicality."
  },
  {
    "objectID": "posts/batchmix/index.html",
    "href": "posts/batchmix/index.html",
    "title": "batchmix: Bayesian mixture modelling for multi-batch data",
    "section": "",
    "text": "My R package, batchmix, finally landed on CRAN. This implements the models described in my paper (Coleman et al. 2022), mixture models aimed at accounting for batch effects.\nThe model is very similar to the ComBat algorithm of Johnson, Li, and Rabinovic (2007), but infers batch effects and class at the same time. This makes the method semi-supervised as it uses the inferred labels to update class parameters. This offers some protection from unequal representation of class across batches which is nice.\nThis post will essentially recreate the vignette for the package showing how to use it."
  },
  {
    "objectID": "posts/batchmix/index.html#data-generation",
    "href": "posts/batchmix/index.html#data-generation",
    "title": "batchmix: Bayesian mixture modelling for multi-batch data",
    "section": "Data generation",
    "text": "Data generation\nWe simulate some data using the generateBatchData function.\n\nlibrary(ggplot2)\nlibrary(batchmix)\nlibrary(mdiHelpR)\n\n\nAttaching package: 'mdiHelpR'\n\n\nThe following object is masked from 'package:batchmix':\n\n    createSimilarityMat\n\n\nThe following object is masked from 'package:methods':\n\n    show\n\nset.seed(1)\nsetMyTheme()\n\n# Data dimensions\nN <- 600\nP <- 4\nK <- 5\nB <- 7\n\n# Generating model parameters\nmean_dist <- 2.25\nbatch_dist <- 0.3\ngroup_means <- seq(1, K) * mean_dist\nbatch_shift <- rnorm(B, mean = batch_dist, sd = batch_dist)\nstd_dev <- rep(2, K)\nbatch_var <- rep(1.2, B)\ngroup_weights <- rep(1 / K, K)\nbatch_weights <- rep(1 / B, B)\ndfs <- c(5, 10, 15, 20, 80)\n\nmy_data <- generateBatchData(\n  N,\n  P,\n  group_means,\n  std_dev,\n  batch_shift,\n  batch_var,\n  group_weights,\n  batch_weights,\n  type = \"MVT\",\n  group_dfs = dfs\n)\n\nThis gives us a named list with two related datasets, the observed_data which includes batch effects and the corrected_data which is batch-free. It also includes group_IDs, a vector indicating class membership for each item, batch_IDs, which indicates batch of origin for each item, and fixed, which indicates which labels are observed and fixed in the model. We pull these out of the names list in the format that the modelling functions desire them.\n\nX <- my_data$observed_data\n\ntrue_labels <- my_data$group_IDs\nfixed <- my_data$fixed\nbatch_vec <- my_data$batch_IDs\n\nalpha <- 1\ninitial_labels <- generateInitialLabels(alpha, K, fixed, true_labels)"
  },
  {
    "objectID": "posts/batchmix/index.html#modelling",
    "href": "posts/batchmix/index.html#modelling",
    "title": "batchmix: Bayesian mixture modelling for multi-batch data",
    "section": "Modelling",
    "text": "Modelling\nGiven some data, we are interested in modelling it. We assume here that the set of observed labels includes at least one example of each class in the data.\n\n# Sampling parameters\nR <- 1000\nthin <- 50\nn_chains <- 4\n\n# Density choice\ntype <- \"MVT\"\n\n# MCMC samples and BIC vector\nmcmc_output <- runMCMCChains(\n  X,\n  n_chains,\n  R,\n  thin,\n  batch_vec,\n  type,\n  initial_labels = initial_labels,\n  fixed = fixed,\n  batch_specific_weights = TRUE\n)\n\nWe want to assess two things. First, how frequently the proposed parameters in the Metropolis-Hastings step are accepted:\n\nplotAcceptanceRates(mcmc_output)\n\n\n\n\nSecondly, we want to asses how well our chains have converged. To do this we plot the complete_likelihood of each chain. This is the quantity most relevant to a clustering/classification, being dependent on the labels. The observed_likelihood is independent of labels and more relevant for density estimation.\n\nplotLikelihoods(mcmc_output)\n\n\n\n\nWe see that our chains disagree. We have to run them for more iterations. We use the continueChains function for this.\n\nR_new <- 9000\n\n# Given an initial value for the parameters\nnew_output <- continueChains(\n  mcmc_output,\n  X,\n  fixed,\n  batch_vec,\n  R_new,\n  keep_old_samples = TRUE\n)\n\nTo see if the chains better agree we re-plot the likelihood.\n\nplotLikelihoods(new_output)\n\n\n\n\nWe also re-check the acceptance rates.\n\nplotAcceptanceRates(new_output)\n\n\n\n\nThis looks like several of the chains agree by the 5,000th iteration."
  },
  {
    "objectID": "posts/batchmix/index.html#process-chains",
    "href": "posts/batchmix/index.html#process-chains",
    "title": "batchmix: Bayesian mixture modelling for multi-batch data",
    "section": "Process chains",
    "text": "Process chains\nWe process the chains, acquiring point estimates of different quantities.\n\n# Burn in\nburn <- 5000\n\n# Process the MCMC samples\nprocessed_samples <- processMCMCChains(new_output, burn)"
  },
  {
    "objectID": "posts/batchmix/index.html#visualisation",
    "href": "posts/batchmix/index.html#visualisation",
    "title": "batchmix: Bayesian mixture modelling for multi-batch data",
    "section": "Visualisation",
    "text": "Visualisation\nFor multidimensional data we use a PCA plot.\n\nchain_used <- processed_samples[[1]]\n\npc <- prcomp(X, scale = T)\npc_batch_corrected <- prcomp(chain_used$inferred_dataset)\n\nplot_df <- data.frame(\n  PC1 = pc$x[, 1],\n  PC2 = pc$x[, 2],\n  PC1_bf = pc_batch_corrected$x[, 1],\n  PC2_bf = pc_batch_corrected$x[, 2],\n  pred_labels = factor(chain_used$pred),\n  true_labels = factor(true_labels),\n  prob = chain_used$prob,\n  batch = factor(batch_vec)\n)\n\nplot_df |> \n  ggplot(aes(\n    x = PC1,\n    y = PC2,\n    colour = true_labels,\n    alpha = prob\n  )) +\n  geom_point()\n\n\n\nplot_df |> \n  ggplot(aes(\n    x = PC1_bf,\n    y = PC2_bf,\n    colour = pred_labels,\n    alpha = prob\n  )) +\n  geom_point()\n\n\n\ntest_inds <- which(fixed == 0)\n\nsum(true_labels[test_inds] == chain_used$pred[test_inds])/length(test_inds)\n\n[1] 0.7212766"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Me",
    "section": "",
    "text": "I am a PhD student in Cambridge working with Bayesian model-based clustering methods."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Barefoot Bayes",
    "section": "",
    "text": "Order By\n       Default\n         \n          Title\n        \n         \n          Author\n        \n     \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\nCircumventing poor mixing in Bayesian model-based clustering\n\n\n\n\n\n\n\nBayes\n\n\n\n\n\n\n\n\n\n\n\nStephen Coleman\n\n\n\n\n\n\n  \n\n\n\n\nCyprus\n\n\n\n\n\n\n\nBayes\n\n\ncoffee\n\n\nrunning\n\n\n\n\n\n\n\n\n\n\n\nStephen Coleman\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMontreal - BAYSM and ISBA\n\n\n\n\n\n\n\nBayes\n\n\n\n\n\n\n\n\n\n\n\nStephen Coleman\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nbatchmix: Bayesian mixture modelling for multi-batch data\n\n\n\n\n\n\n\nBayes\n\n\n\n\n\n\n\n\n\n\n\nStephen Coleman\n\n\n\n\n\n\nNo matching items"
  }
]